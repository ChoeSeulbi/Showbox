<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <title>DETAIL</title>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="./js/Header.js"></script>
    <script src="./js/Footer.js"></script>
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/active.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div id="wrap">
      <!-- 헤더 -->
      <component-header></component-header>

      <div id="content" class="detail-contents">
        <div class="inner">
          <div class="top">
            <h2>SHOWBOX MOVIE</h2>
            <div class="menu-list">
              <ul>
                <li class="active"><a href="lineup.html">LINE-UP</a></li>
                <li><a href="now.html">NOW IN THEATERS</a></li>
              </ul>
            </div>
          </div>
          <!-- 영화 상세 정보 -->
          <div class="mid detail">
            <h2 class="title">xkdldm</h2>
            <div>이미지</div>
            <div>설명</div>
          </div>
        </div>
      </div>

      <!-- 타이틀, 포스터, 설명, 등장인물, 예고편? -->

      <!-- 푸터 -->
      <component-footer></component-footer>
    </div>
    <script src="js/script.js"></script>
    <script type="text/javascript">
      let page = 1;
      let container = document.querySelector(".detail-contents .detail");
      const posterUrl = "https://image.tmdb.org/t/p/w300";
      const options = {
        method: "GET",
        headers: {
          accept: "application/json",
          Authorization:
            "Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJjNDE5Yzk1OTU4MGFkZTI0MmI5ZmY3ZTZhNjY0ZjI0MSIsInN1YiI6IjYyMjk5NjllMTA5Y2QwMDA0NTkyNGVmMiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.cE41jpVp7Ygww8zxlTMu1A3t7tvlAb1kr9nXZZEGNJM",
        },
      };

      let urlParams = new URLSearchParams(window.location.search);
      let movieId = urlParams.get("id");
      console.log(movieId);

      function fetchMovie() {
        fetch(
          `https://api.themoviedb.org/3/movie/${movieId}?language=ko-KO`,
          options
        )
          .then((response) => response.json())
          .then(function (response) {
            // let movies = response.results;
            console.log(response);
            let detailContents = document.querySelector(".detail");
            // title.innerText = response.title;

            // let div = document.createElement("div");
            let html = `
              <h2>${response.title}</h2>
              <div><img src="${posterUrl + response.poster_path}"></div>
              <div>
                <p>개봉일 : ${response.release_date}</p>
                <p>장르 : ${response.genres
                  .map((genre) => genre.name)
                  .join(", ")}</p>
                <p>평점 : ${response.vote_average}</p>
                <p>${response.overview}</p>  
              </div>
            `;

            detailContents.innerHTML = html;

            // movies.map(function (movie) {
            //   console.log(movie.title);
            //   let div = document.createElement("div");
            //   let html = `
            //             <div class="img-wrap"><img src="${
            //               posterUrl + movie.poster_path
            //             }" alt="${movie.title}"></div>
            //             <div class="movie-title"><a href="">${
            //               movie.title
            //             }</a></div>
            //             <div class="movie-overview"><p>${
            //               movie.overview
            //             }</p></div>
            //             `;
            //   div.innerHTML = html;
            //   container.appendChild(div);
            // });
          })
          .catch((err) => console.error(err));
      }
      window.addEventListener("load", fetchMovie());
    </script>
  </body>
</html>
